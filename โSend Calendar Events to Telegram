// === CONFIG ===
// üëâ ‡πÉ‡∏™‡πà Calendar ID ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏∂‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏°‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
var CalendarId = "myemail@gmail.com"; // üìå ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ Calendar ID ‡πÄ‡∏â‡∏û‡∏≤‡∏∞

// üëâ ‡πÉ‡∏™‡πà Token ‡∏Ç‡∏≠‡∏á Telegram Bot ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
var telegramToken = "YOUR_TELEGRAM_BOT_TOKEN";  // üìå ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11

// üëâ ‡πÉ‡∏™‡πà Chat ID ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
var chatId = "YOUR_TELEGRAM_CHAT_ID";  // üìå ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ -100...


// === MAIN FUNCTION ===
// üëâ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô (‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô Trigger ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ)
function dailyEventMessage() {
  var today = new Date();
  var calendar = CalendarApp.getCalendarById(CalendarId);
  var eventList = calendar.getEventsForDay(today);

  // üõë ‡∏™‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
  if (eventList.length > 0) {
    var message = getEventMessage(today, eventList);
    Logger.log(message); // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô Log
    sendTelegramNotify(message);
  }
}

// === FORMAT MESSAGE ===
// üëâ ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Telegram
function getEventMessage(date, eventList) {
  var formattedDate = date.toLocaleDateString("th-TH", { day: "numeric", month: "long", year: "numeric" });
  var message = `üì£ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formattedDate} \nüî∂ ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${eventList.length} ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°`;

  eventList.forEach((event, index) => {
    var eventTitle = `üìÅ ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : ${event.getTitle()}`;
    var startTime = event.getStartTime().toTimeString().slice(0, 5);
    var endTime = event.getEndTime().toTimeString().slice(0, 5);
    var eventTime = `‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤ : ${startTime}-${endTime}`;
    var eventDescription = event.getDescription() ? `üìç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ${event.getDescription()}` : "üìç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : -";
    
    message += `\n${index + 1}. ${eventTitle}\n    ${eventTime}\n    ${eventDescription}\n`;
  });

  return message;
}

// === SEND TO TELEGRAM ===
// üëâ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á Telegram ‡∏ú‡πà‡∏≤‡∏ô Bot API
function sendTelegramNotify(message) {
  var telegramUrl = `https://api.telegram.org/bot${telegramToken}/sendMessage`;

  var payload = {
    'chat_id': chatId,
    'text': message,
    'parse_mode': 'Markdown' // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 'HTML' ‡πÑ‡∏î‡πâ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  };

  var options = {
    'method': 'post',
    'contentType': 'application/json',
    'payload': JSON.stringify(payload)
  };

  UrlFetchApp.fetch(telegramUrl, options);
}
