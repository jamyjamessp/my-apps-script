function getData() {
  let spreadsheetId = "156XrR9Jn30wNiciPhHraHVYAdiyQD-v1-yNpV7oxUNI";
  let spreadsheet = SpreadsheetApp.openById(spreadsheetId);
  let sheet = spreadsheet.getSheetByName("thairath");

  if (!sheet) {
    Logger.log("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏µ‡∏ï‡∏ä‡∏∑‡πà‡∏≠ 'thairath'");
    return;
  }

  let data = sheet.getDataRange().getDisplayValues();
  let message = "";

  // ‚úÖ ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö dd/mm/yy (‡∏û.‡∏®.)
  let todayDate = new Date();
  let day = String(todayDate.getDate()).padStart(2, '0'); 
  let month = String(todayDate.getMonth() + 1).padStart(2, '0'); 
  let year = String(todayDate.getFullYear() + 543).slice(-2); 

  let today = `${day}/${month}/${year}`;  
  Logger.log("Today's date (Buddhist yy): '" + today + "'");

  for (let i = 1; i < data.length; i++) {
    let rawDate = data[i][2].trim(); 
    let formattedDate = rawDate.replace(/\s/g, ""); 

    if (formattedDate === today) {
      message += `üìå *‡∏•‡∏≥‡∏î‡∏±‡∏ö*: ${data[i][0]}\n`;
      message += `üî¢ *‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°*: ${data[i][1]}\n`;
      message += `üìÖ *‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà*: ${data[i][2]}\n`;
      message += `üìñ *‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á*: ${data[i][3]}\n`;
      message += `‚úçÔ∏è *‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠*: ${data[i][5]}\n\n`;
      Logger.log("‚úÖ Match found! Adding to message.");
    }
  }

  // ‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
  if (message !== "") {
    let token = "7234237304:AAF9Wju9_RcEugVTStUtva9mDCJruF5oxpg";
    let chatId = "-1002550642445";

    let telegramUrl = 'https://api.telegram.org/bot' + token + '/sendMessage';

    let payload = {
      'chat_id': chatId,
      'text': message,
      'parse_mode': 'Markdown'
    };

    let options = {
      'method': 'post',
      'contentType': 'application/json',
      'payload': JSON.stringify(payload)
    };

    UrlFetchApp.fetch(telegramUrl, options);
  } else {
    Logger.log("‚ùå No new messages today. No Telegram message sent.");
  }
}
